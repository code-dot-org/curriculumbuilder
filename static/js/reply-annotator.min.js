var _ref,__bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(d,b){for(var a in b){if(__hasProp.call(b,a)){d[a]=b[a]}}function c(){this.constructor=d}c.prototype=b.prototype;d.prototype=new c();d.__super__=b.prototype;return d};Annotator.Plugin.Reply=(function(b){__extends(a,b);function a(){this.pluginSubmit=__bind(this.pluginSubmit,this);this.updateField=__bind(this.updateField,this);_ref=a.__super__.constructor.apply(this,arguments);return _ref}a.prototype.field=null;a.prototype.input=null;a.prototype.pluginInit=function(){console.log("Reply-pluginInit");if(!Annotator.supported()){return}this.field=this.annotator.editor.addField({type:"input",load:this.updateField,submit:this.pluginSubmit,});var d=Annotator.$('<li class="annotator-item reply-item" style="display:none"><span class="parent-annotation">0</span></li>');Annotator.$(this.field).replaceWith(d);this.field=d[0];var c=this.annotator.viewer.addField({load:this.updateViewer,});return this.input=$(this.field).find(":input")};a.prototype.pluginSubmit=function(e,c){var f=$(this.annotator.editor.element).find(".reply-item span.parent-annotation"),d=f.html()!=""?f.html():"0";if(d!="0"){c.media="comment"}c.parent=d;return c.parent};a.prototype.updateViewer=function(f,c){var d=this,f=$(f),e=f.addClass("reply-viewer-annotator").html(function(){var g;return d});this.annotation=c;return e};a.prototype.updateField=function(d,c){var e=$(this.annotator.editor.element).find(".reply-item span.parent-annotation");return e.html("0")};return a})(Annotator.Plugin);